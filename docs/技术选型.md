# AI白板项目技术选型

## 基础技术栈
- **前端框架**: React
- **后端运行时**: Node.js
- **项目管理**: Monorepo

---

## 1. 包管理器选择: npm vs pnpm vs bun

### 对比分析

| 特性 | npm | pnpm | bun |
|------|-----|------|-----|
| **安装速度** | ⭐⭐ 较慢 | ⭐⭐⭐⭐ 快 | ⭐⭐⭐⭐⭐ 极快 |
| **磁盘占用** | ⭐⭐ 高（每个项目独立） | ⭐⭐⭐⭐⭐ 低（符号链接共享） | ⭐⭐⭐⭐ 较低 |
| **Monorepo 支持** | ⭐⭐⭐ 基础支持（workspaces） | ⭐⭐⭐⭐⭐ 优秀（原生优化） | ⭐⭐⭐⭐ 良好 |
| **生态兼容性** | ⭐⭐⭐⭐⭐ 完美 | ⭐⭐⭐⭐ 优秀 | ⭐⭐⭐ 成长中 |
| **成熟度** | ⭐⭐⭐⭐⭐ 非常成熟 | ⭐⭐⭐⭐ 成熟稳定 | ⭐⭐ 较新（2021+） |
| **学习曲线** | ⭐⭐⭐⭐⭐ 最简单 | ⭐⭐⭐⭐ 简单 | ⭐⭐⭐ 需要适应 |
| **CI/CD 支持** | ⭐⭐⭐⭐⭐ 默认支持 | ⭐⭐⭐⭐ 广泛支持 | ⭐⭐⭐ 需配置 |

### 详细分析

#### npm (Node Package Manager)
**优势**:
- Node.js 官方自带，零配置
- 生态最完善，兼容性最好
- 团队成员上手零门槛
- Workspaces 功能支持基础 Monorepo 需求
- CI/CD 环境默认支持

**劣势**:
- 安装速度相对较慢
- 磁盘空间占用大（node_modules 重复）
- Monorepo 管理功能相对弱

**适用场景**: 稳定优先、团队规模小、对速度要求不高

---

#### pnpm (Performant npm)
**优势**:
- **安装速度快** - 比 npm 快 2-3 倍
- **极省磁盘空间** - 使用硬链接/符号链接，所有项目共享依赖
- **Monorepo 原生支持** - pnpm-workspace.yaml 配置简洁
- **严格的依赖管理** - 避免幽灵依赖（phantom dependencies）
- **成熟稳定** - 被 Vue 3、Vite、TurboRepo 等大型项目使用
- **与 npm 高度兼容** - 命令几乎一致

**劣势**:
- 需要额外安装 `npm install -g pnpm`
- 某些老旧包可能有兼容性问题（极少）
- 符号链接在 Windows 某些场景下可能有坑

**适用场景**: 中大型 Monorepo、追求性能和磁盘效率

---

#### Bun
**优势**:
- **极致性能** - 使用 Zig 编写，安装速度最快
- **All-in-One** - 包管理、打包、测试、运行时一体化
- **现代化设计** - 原生支持 TypeScript、JSX
- **未来潜力大** - 对标 Node.js 的新一代运行时

**劣势**:
- **生态不够成熟** - 2021 年才发布，部分包可能不兼容
- **社区较小** - 遇到问题解决方案少
- **生产环境风险** - 企业级项目使用案例较少
- **API 仍在变化** - 版本迭代可能带来 breaking changes
- **CI/CD 支持** - 需要额外配置

**适用场景**: 个人项目、实验性项目、追求极致性能

---

## 推荐方案

### 🎯 **推荐: pnpm**

#### 理由:
1. **Monorepo 最佳实践** - pnpm 是专为 Monorepo 优化的包管理器
2. **性能与稳定性平衡** - 比 npm 快，比 bun 稳定
3. **企业级验证** - Microsoft、ByteDance、Shopify 等大厂在用
4. **学习成本低** - 命令与 npm 几乎一致，团队可无缝切换
5. **长期收益** - 磁盘空间节省、安装速度提升在大项目中价值显著

#### 备选方案:
- 如果团队对新工具接受度低，担心兼容性 → 选择 **npm**
- 如果是个人项目，愿意尝鲜新技术 → 选择 **bun**

---

## 下一步决策

一旦确定包管理器，需要决定:
1. **Monorepo 工具**: Turborepo / Nx / Lerna / 原生 workspaces
2. **前端框架**: Next.js / Vite + React
3. **后端框架**: Express / Fastify / NestJS
4. **数据库**: PostgreSQL / MongoDB / ...
5. **AI 集成方案**: OpenAI API / Anthropic Claude / 自建模型

---

## 决策记录

- **日期**: 2026-01-14
- **状态**: ⏸️ 待确认
- **决策者**: Vincent + Claude Code
